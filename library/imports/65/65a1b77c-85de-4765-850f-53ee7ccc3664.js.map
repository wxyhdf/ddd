{"version":3,"sources":["..\\..\\..\\..\\assets\\Script/assets\\Script\\gameScene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["const {\r\n    ccclass,\r\n    property\r\n} = cc._decorator;\r\n\r\nimport {\r\n    GameHelper\r\n} from './common/gameHelper';\r\n\r\nimport config from './common/config';\r\nimport { Units } from './common/units';\r\nimport { AssetLoader } from './common/assetLoader';\r\n@ccclass\r\nexport default class GameScene extends cc.Component {\r\n\r\n    /**\r\n     * 砖头\r\n     */\r\n    @property(cc.Node)\r\n    robot: cc.Node = null;\r\n    /**\r\n     * 背景节点\r\n     */\r\n    @property(cc.Node)\r\n    background: cc.Node = null;\r\n    /**\r\n     * 摄像机\r\n     */\r\n    @property(cc.Node)\r\n    camera: cc.Node = null;\r\n    /**\r\n    * 小方块的颜色\r\n    */\r\n    @property(cc.Color)\r\n    smallBlock: cc.Color = cc.color(255, 199, 67, 255);\r\n    /**\r\n     * 方块预制体\r\n     */\r\n    @property(cc.Prefab)\r\n    block: cc.Prefab = null;\r\n    /**\r\n    * 方块生成之间的高度距离\r\n    */\r\n    @property(cc.Float)\r\n    block_Between_Height: number = 300;\r\n    /**\r\n     * 栏杆\r\n     */\r\n    @property(cc.Node)\r\n    railingNode: cc.Node = null;\r\n    /**\r\n     * 方块生成的父节点\r\n     */\r\n    @property(cc.Node)\r\n    blockNode: cc.Node = null;\r\n    /**\r\n     * 画笔\r\n     */\r\n    @property(cc.Graphics)\r\n    draw: cc.Graphics = null;\r\n\r\n    @property(cc.Prefab)\r\n    railing: cc.Prefab = null;\r\n\r\n    start_touch_one: boolean = false;\r\n\r\n    /**\r\n     * 触发开始Game\r\n     */\r\n    OnGameStart(e) {\r\n        if (!this.start_touch_one) {\r\n            this.start_touch_one = true;\r\n            //设置重力加速度\r\n            //cc.director.getPhysicsManager().gravity = cc.v2(0, -640);\r\n            let rigidbody = this.robot.getComponent(cc.RigidBody);\r\n            //施加往上的力\r\n            rigidbody.applyLinearImpulse(cc.v2(0, 3000), rigidbody.getWorldCenter(), true);\r\n            cc.tween(this.robot).to(0.5, { angle: -180 }).call(() => {\r\n                this.robot.getChildByName(\"info\").active = true;\r\n                \r\n                this.robot.getChildByName(\"info\").getChildByName(\"label\").getComponent(cc.Label).string = GameHelper.GameInfo.blood.toString();\r\n                this.robot.getComponent(\"figure\").startRun();\r\n            }).start();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 加血对象池\r\n     */\r\n    bloodPool: AssetLoader.FactoryPool = new AssetLoader.FactoryPool();\r\n    /**\r\n    * 当前存在的加血buff  用于回收加血节点\r\n    */\r\n    bloodArray: Units.List<cc.Node> = new Units.List<cc.Node>();\r\n    /**\r\n     * 当前关卡方块生成配置数组\r\n     */\r\n    blockConfig: cc.Vec2[][] = [];\r\n    /**\r\n     * 方块节点池\r\n     */\r\n    blockPool: AssetLoader.FactoryPool = new AssetLoader.FactoryPool();\r\n    /**\r\n     * 当前存在的方块  用于回收方块\r\n     */\r\n    blockArray: Units.List<cc.Node> = new Units.List<cc.Node>();\r\n    /**\r\n     * 第一块方块生成的y轴坐标\r\n     */\r\n    blockCurrentPOSY: number = 0;\r\n    /**\r\n     * 当前方块生成的配置指向索引 用来读取blockConfig当前关卡方块生成配置数组\r\n     */\r\n    blockCurrentId: number = 0;\r\n    /**\r\n     * 当前的背景指向索引 用来读取backgroundPool背景节点数组\r\n     */\r\n    currentBackgroundId: number = 0;\r\n    /**\r\n     * 背景节点数组\r\n     */\r\n    backgroundPool: cc.Node[] = [];\r\n    /**\r\n     * 生成背景(第一次生成三张背景图)\r\n     */\r\n    createBackground() {\r\n        /**\r\n         * 第一次生成方块的位置在第一张背景图下面的200px位置\r\n         */\r\n        this.blockCurrentPOSY = this.background.y + this.background.height / 2 - 200;\r\n        this.backgroundPool.push(this.background);\r\n        let bg2 = cc.instantiate(this.background);\r\n        bg2.y = this.background.y - bg2.height;\r\n        this.backgroundPool.push(bg2);\r\n        let bg3 = cc.instantiate(this.background);\r\n        bg3.y = bg2.y - bg3.height;\r\n        this.backgroundPool.push(bg3);\r\n        bg2.setParent(this.background.getParent());\r\n        bg3.setParent(this.background.getParent());\r\n    }\r\n\r\n    /**\r\n     * 根据配置计算出所有方块生成的坐标\r\n     * @param config 关卡方块配置\r\n     */\r\n    createConfigCoordinate(config: number[][]) {\r\n        let visi = cc.view.getVisibleSize();\r\n\r\n        //this.blockConfig = config;\r\n        for (const items of config) {\r\n            let _item = [];\r\n            for (const key in items) {\r\n                if (items.hasOwnProperty(key)) {\r\n                    const item = items[key];\r\n                    if (item) {\r\n                        let x = visi.width / 10 + visi.width / 5 * Number(key);\r\n                        _item.push(cc.v2(x, this.blockCurrentPOSY));\r\n                    }\r\n                }\r\n            }\r\n            this.blockConfig.push(_item);\r\n            this.blockCurrentPOSY -= this.block_Between_Height;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 生成加血buff\r\n     */\r\n    createBlood() {\r\n        let ran = Math.floor(Math.random() * 10);\r\n        // 1/2几率生成加血buff\r\n        if (ran < 6) {\r\n            //随机生成1~3个\r\n            let num = Math.floor(Math.random() * 2) + 1;\r\n            //随机通道\r\n            let pip = [];\r\n            while (true) {\r\n                let p = Math.floor(Math.random() * 5);\r\n                if (pip.indexOf(p) == -1) {\r\n                    pip.push(p);\r\n                }\r\n                if (pip.length == num) break;\r\n            }\r\n            let visi = cc.view.getVisibleSize();\r\n            for (let i = 0; i < pip.length; i++) {\r\n                this.bloodPool.acyncCreate<cc.Prefab>(\"prefab/bloodNode\", cc.Prefab).then((node) => {\r\n                    let x = visi.width / 10 + visi.width / 5 * pip[i];\r\n                    let pos = this.blockNode.convertToNodeSpaceAR(cc.v2(x, this.blockCurrentPOSY - 450));\r\n                    node.setPosition(pos);\r\n                    let b = Math.floor(Math.random() * 10) + 1;\r\n                    node.getChildByName(\"label\").getComponent(cc.Label).string = b.toString();\r\n                    this.blockNode.addChild(node);\r\n                })\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 生成方块\r\n     */\r\n    createBlock(): boolean {\r\n        let visi = cc.view.getVisibleSize();\r\n        let width = visi.width / 5;\r\n        if (this.blockCurrentId == this.blockConfig.length) return false;\r\n        let blockCoordinate = this.blockConfig[this.blockCurrentId];\r\n        for (const item of blockCoordinate) {\r\n            //更新方块所指向y轴坐标\r\n            this.blockCurrentPOSY = this.blockNode.convertToNodeSpaceAR(item).y;\r\n            this.blockPool.acyncCreate<cc.Prefab>(\"prefab/block\", cc.Prefab).then((node) => {\r\n                node.width = width;\r\n                node.height = width;\r\n                let collider = node.getComponent(cc.PhysicsBoxCollider);\r\n                collider.size.width = width;\r\n                collider.size.height = width;\r\n                let star = node.getChildByName(\"star\");\r\n                star.width = width;\r\n                star.height = width;\r\n                let label = node.getChildByName(\"label\");\r\n                label.getComponent(cc.Label).string = Math.floor(Math.random() * 30 + 1).toString();\r\n                node.setPosition(this.blockNode.convertToNodeSpaceAR(item));\r\n                this.blockArray.add(node);\r\n                this.blockNode.addChild(node);\r\n            })\r\n        }\r\n        this.createBlood();\r\n        //最后一波不生成血量\r\n        //if (this.blockCurrentId == this.blockConfig.length - 1) \r\n\r\n        this.blockCurrentId++;\r\n        return true;\r\n    }\r\n\r\n\r\n\r\n    init() {\r\n        this.node.on(cc.Node.EventType.TOUCH_START, this.OnGameStart, this);\r\n        this.node.on(GameHelper.NodeEvent.HitBlock, (ev: cc.Event.EventCustom) => {\r\n            let node = ev.getUserData()[\"target\"] as cc.Node;\r\n            GameHelper.GameInfo.blood--;\r\n            if (GameHelper.GameInfo.blood == 0) {\r\n                this.robot.removeFromParent();\r\n                alert(\"Game Over\")\r\n            }\r\n            this.robot.getChildByName(\"info\").getChildByName(\"label\").getComponent(cc.Label).string = GameHelper.GameInfo.blood.toString();\r\n            let label = node.getChildByName(\"label\");\r\n            let blood = Number(label.getComponent(cc.Label).string) - 1;\r\n            if (blood == 0) {\r\n                this.blockPool.onKilled(node);\r\n            }\r\n            label.getComponent(cc.Label).string = blood.toString();\r\n        })\r\n        this.node.on(GameHelper.NodeEvent.AddBlood, (ev: cc.Event.EventCustom) => {\r\n            let node = ev.getUserData()[\"target\"] as cc.Node;\r\n            let blood = Number(node.getChildByName(\"label\").getComponent(cc.Label).string);\r\n            //加血\r\n            GameHelper.GameInfo.blood += blood;\r\n            //回收节点\r\n            this.bloodPool.onKilled(node);\r\n            //更新血量\r\n            this.robot.getChildByName(\"info\").getChildByName(\"label\").getComponent(cc.Label).string = GameHelper.GameInfo.blood.toString();\r\n        })\r\n    }\r\n    /**\r\n     * 画笔开始画画的起点\r\n     */\r\n    draw_Start_PointY: number = 0;\r\n\r\n    onLoad() {\r\n        //开启物理系统\r\n        cc.director.getPhysicsManager().enabled = true;\r\n        //设置重力加速度\r\n        cc.director.getPhysicsManager().gravity = cc.v2(0, 0);\r\n        //cc.director.getPhysicsManager().debugDrawFlags = cc.PhysicsManager.DrawBits.e_aabbBit | cc.PhysicsManager.DrawBits.e_jointBit | cc.PhysicsManager.DrawBits.e_shapeBit;\r\n\r\n        //生成背景节点\r\n        this.createBackground();\r\n        //设置画笔起始y轴坐标\r\n        this.draw_Start_PointY = this.robot.y - this.robot.height / 2;\r\n        this.draw.moveTo(0, this.robot.y - this.robot.height / 2);\r\n        //使用第一关的关卡配置;\r\n        this.createConfigCoordinate(config.pass_1);\r\n        //首先生成一次方块\r\n        this.createBlock();\r\n\r\n        //this.spawnNewPlayer();\r\n        this.init();\r\n    }\r\n    /**\r\n    * 判断节点是否可见\r\n    * @param node 节点\r\n    */\r\n    isVisible(node: cc.Node): boolean {\r\n        let visi = cc.view.getVisibleSize();\r\n        if (this.camera.y + visi.height / 2 < node.y - node.height / 2) return false;\r\n        return true;\r\n    }\r\n\r\n    /**\r\n    * 判断节点是否可见\r\n    * @param node 节点\r\n    */\r\n    pointDirectionByVisible(node: cc.Node): GameHelper.Direction {\r\n        let visi = cc.view.getVisibleSize();\r\n        if (this.camera.y + visi.height / 2 < node.y - node.height / 2) return GameHelper.Direction.Up;\r\n        if (this.camera.y - visi.height / 2 > node.y + node.height / 2) return GameHelper.Direction.Down;\r\n        return GameHelper.Direction.Visible;\r\n    }\r\n    /**\r\n     * 移动背景节点\r\n     */\r\n    moveBackground() {\r\n        if (!this.isVisible(this.backgroundPool[this.currentBackgroundId])) {\r\n            let back = this.backgroundPool[this.currentBackgroundId];\r\n            let prebackId = this.currentBackgroundId - 1;\r\n            if (prebackId < 0) prebackId = this.backgroundPool.length - 1;\r\n            let prebak = this.backgroundPool[prebackId];\r\n            back.y = prebak.y - back.height;\r\n            this.currentBackgroundId++;\r\n            if (this.currentBackgroundId >= this.backgroundPool.length) this.currentBackgroundId = 0;\r\n            //console.log(this.backgroundPool)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 是否可以预加载下一批方块和回收方块\r\n     */\r\n    isPreCreateBlock() {\r\n        //获取当前y轴指向的方块\r\n        let node = this.blockArray.firstOrDefault(item => item.y == this.blockCurrentPOSY);\r\n        //判断当前y轴指向的方块是否可见 可见则生成下一波方块\r\n        if (node && this.pointDirectionByVisible(node) == GameHelper.Direction.Visible) {\r\n            this.createBlock();\r\n        }\r\n        //获取回收节点  如果节点在可见屏幕的上方 则回收方块\r\n        let removeItems = this.blockArray.where(item => this.pointDirectionByVisible(item) == GameHelper.Direction.Up);\r\n        //移除方块\r\n        this.blockArray.removeRange(removeItems);\r\n        //回收节点\r\n        for (const item of removeItems) {\r\n            this.blockPool.onKilled(item);\r\n        }\r\n        //获取回收节点  如果节点在可见屏幕的上方 则回收血量\r\n        removeItems = this.bloodArray.where(item => this.pointDirectionByVisible(item) == GameHelper.Direction.Up);\r\n        //移除血量buff\r\n        this.bloodArray.removeRange(removeItems);\r\n        //回收血量buff\r\n        for (const item of removeItems) {\r\n            this.bloodPool.onKilled(item);\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n    start() {\r\n\r\n    }\r\n\r\n    update(dt) {\r\n        this.moveBackground();\r\n        this.isPreCreateBlock();\r\n        if (this.robot.y < this.draw_Start_PointY) {\r\n            this.draw.lineTo(this.robot.x, this.robot.y);\r\n            this.draw.lineWidth = 40;\r\n            this.draw.strokeColor = cc.Color.RED;\r\n            this.draw.stroke();\r\n        }\r\n    }\r\n\r\n}"]}